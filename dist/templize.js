var Templize=function(a){this.source=a};Templize.prototype.renderChildren=function(a,b){for(var c=[],d=b.childNodes,e=0;e<d.length;e++){var f=d[e],g=this.render(a,f);g instanceof Array?Array.prototype.push.apply(c,g):c.push(g)}return c},Templize.prototype.render=function(a,b){if(!b){var c=document.createElement("div");return c.innerHTML=this.source.replace(/%([a-zA-Z0-9_-]+)%/g,function(b,c){return a[c]}),this.render(a,c)}var d=b.nodeName;if("T"==d&&(d=b.id.toUpperCase()),"ECHO"==d){var e=b.textContent.trim();return document.createTextNode(a[e])}if("IF"==d){var f=b.getAttribute("true"),g=b.getAttribute("false");return f&&a[f]||g&&!a[g]?this.renderChildren(a,b):[]}if("LOOP"==d){var h,i=b.getAttribute("array"),j=b.getAttribute("object");if(i)h=function(a,b){for(var c=a[i],d=0;d<c.length;d++){var e=c[d];b(d,e,0==d,d==c.length-1)}};else{if(!j)throw new Error('<loop> tag must contain "array" or "object" attribute.');h=function(a,b){var c,d=a[j],e=0;for(var f in d)d.hasOwnProperty(f)&&(e&&b(c,d[c],1==e,!1),e++,c=f);c&&b(c,d[c],1==e,!0)}}var k=[],l=a.key,m=a.value,n=a.first,o=a.last;return h(a,function(c,d,e,f){a.key=c,a.value=d,a.first=e,a.last=f;var g=this.renderChildren(a,b);Array.prototype.push.apply(k,g)}.bind(this)),a.key=l,a.value=m,a.first=n,a.last=o,k}if("#text"==d)return document.createTextNode(b.textContent);if("#comment"==d)return document.createComment(b.textContent);var p=b.cloneNode(!1);return this.renderChildren(a,b).forEach(function(a){p.appendChild(a)}),p},window.Tempilze=window.Templize||Templise;